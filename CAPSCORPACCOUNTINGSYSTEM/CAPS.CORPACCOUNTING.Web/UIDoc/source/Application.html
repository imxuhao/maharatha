<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * The main application class. An instance of this class is created by app.js when it
 * calls Ext.application(). This is the ideal place to handle application launch and
 * initialization details.
 */
Ext.require(
[&#39;Ext.*&#39;]);
Ext.define(&#39;Chaching.Application&#39;, {
    extend: &#39;Ext.app.Application&#39;,

    name: &#39;Chaching&#39;,
    requires: [
        &#39;Chaching.view.common.grid.ChachingGridPanel&#39;,
        &#39;Ext.saki.grid.MultiSearch&#39;,
        &#39;Ext.ux.grid.MultiSort&#39;,
        &#39;Ext.saki.form.field.Icon&#39;,
        &#39;Chaching.*&#39;
    ],
    stores: [
        // TODO: add global / shared stores here
         &#39;NavigationTree&#39;,
         &#39;tenants.TenantsStore&#39;,
         &#39;users.UsersStore&#39;,
         &#39;roles.RolesStore&#39;,
         &#39;editions.EditionsStore&#39;,
         &#39;languages.LanguagesStore&#39;,
        &#39;auditlogs.AuditLogsStore&#39;,
        &#39;languages.LanguageTextsStore&#39;,
        &#39;profile.linkedaccounts.LinkedAccountsStore&#39;,
        &#39;financials.accounts.ChartOfAccountStore&#39;,
        &#39;profile.loginAttempts.LoginAttemptStore&#39;,
        &#39;manageView.ManageViewStore&#39;,
        &#39;financials.accounts.SubAccountsStore&#39;,
        &#39;financials.accounts.DivisionsStore&#39;,
        &#39;manageView.ManageViewStore&#39;,
        &#39;roles.RolesTreeStore&#39;,
        &#39;languages.LanguagesDataStore&#39;
      
    ],
    mainView: &#39;Chaching.view.main.ChachingViewport&#39;,
    launch: function () {
        var me = this;
        ///****Load usersDefaultView Settings
        var defaultViewSettingStore = Ext.create(&#39;Chaching.store.manageView.ManageViewStore&#39;);
        var filters = [];
        var filter = new Ext.util.Filter({
            entity: &#39;&#39;,
            searchTerm: true,
            comparator: 1,
            dataType: 3,
            property: &#39;isDefault&#39;,
            value: true
        });
        filters.push(filter);
        filter = new Ext.util.Filter({
            entity: &#39;&#39;,
            searchTerm: Chaching.utilities.ChachingGlobals.loggedInUserInfo.userId,
            comparator: 2,
            dataType: 0,
            property: &#39;userId&#39;,
            value: Chaching.utilities.ChachingGlobals.loggedInUserInfo.userId
        });
        filters.push(filter);
        defaultViewSettingStore.filter(filters);
        defaultViewSettingStore.load({
            callback: function (records, operation, success) {
                if (success &amp;&amp; records &amp;&amp; records.length &gt; 0) {
                    var usersDefaultGridViewSettings = [];
                    var rec;
                    Ext.each(records, function (record) {
                        if (record.get(&#39;isDefault&#39;)) {
                            rec = {
                                gridId: record.get(&#39;gridId&#39;),
                                userViewId: record.get(&#39;userViewId&#39;),
                                viewSettingName: record.get(&#39;viewSettingName&#39;),
                                viewSettings: record.get(&#39;viewSettings&#39;),
                                isDefault: record.get(&#39;isDefault&#39;)
                            }
                            usersDefaultGridViewSettings.push(rec);
                        }
                    });
                    Chaching.utilities.ChachingGlobals.usersDefaultGridViewSettings = usersDefaultGridViewSettings;

                    if (me &amp;&amp; window.location.hash &amp;&amp; window.location.hash !== &quot;#dashboard&quot;) {
                        var mainView = me.getMainView();
                        if (mainView) {
                            var mainViewController = mainView.getController(),
                                refs = mainViewController.getReferences(),
                                mainCardPanel = refs.mainCardPanel,
                                hasComponent = mainCardPanel.child(&#39;component[routeId=&#39; + window.location.hash.replace(&#39;#&#39;, &#39;&#39;) + &#39;]&#39;);
                            if (hasComponent&amp;&amp;typeof(hasComponent.applyGridViewSetting)===&#39;function&#39;) {
                                var cols = hasComponent.getColumns();
                                hasComponent.applyGridViewSetting(cols, true);
                            }
                        }
                    }
                }
            }
        });
    },
    onAppUpdate: function () {
        Ext.Msg.confirm(&#39;Application Update&#39;, &#39;This application has an update, reload?&#39;,
            function (choice) {
                if (choice === &#39;yes&#39;) {
                    window.location.reload();
                }
            }
        );
    }
});
</pre>
</body>
</html>
